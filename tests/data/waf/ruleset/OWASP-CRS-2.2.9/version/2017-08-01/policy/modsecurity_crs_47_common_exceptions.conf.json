{"ruleset_id":"__na__","ruleset_version":"__na__","directive":[{"sec_rule":{"variable":[{"type":"REQUEST_LINE","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^GET /$","is_regex":true,"is_negated":false,"_reserved_1":66626736},"action":{"id":"981020","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE"]},"chained_rule":[{"variable":[{"type":"REMOTE_ADDR","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^(127\\.0\\.0\\.|\\:\\:)1$","is_regex":true,"is_negated":false,"_reserved_1":66596288},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE"]},"hidden":false},{"variable":[{"type":"TX","match":[{"value":"PROTOCOL_VIOLATION\\\\\\/MISSING_HEADER","is_negated":false,"is_regex":true,"_reserved_1":66625104}],"is_count":false}],"operator":{"type":"RX","value":".*","is_regex":true,"is_negated":false,"_reserved_1":66608688},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","setvar":[{"scope":"TX","var":"missing_header","op":"INCREMENT","val":"1"},{"scope":"TX","var":"missing_header_%{tx.missing_header}","op":"ASSIGN","val":"%{matched_var_name}"}]},"hidden":false},{"variable":[{"type":"TX","match":[{"value":"MISSING_HEADER_","is_negated":false,"is_regex":true,"_reserved_1":66603568}],"is_count":false}],"operator":{"type":"RX","value":"TX\\:(.*)","is_regex":true,"is_negated":false,"_reserved_1":66596432},"action":{"capture":true,"file":"modsecurity_crs_47_common_exceptions.conf","setvar":[{"scope":"TX","var":"%{tx.1}","op":"DELETE"}],"t":["NONE"]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_LINE","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^(GET /|OPTIONS \\*) HTTP/1.0$","is_regex":true,"is_negated":false,"_reserved_1":66608832},"action":{"id":"981021","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE"]},"chained_rule":[{"variable":[{"type":"REMOTE_ADDR","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^(127\\.0\\.0\\.|\\:\\:)1$","is_regex":true,"is_negated":false,"_reserved_1":66610400},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE"]},"hidden":false},{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"User-Agent","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":"^.*\\(internal dummy connection\\)$","is_regex":true,"is_negated":false,"_reserved_1":66605968},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE","NONE"]},"hidden":false},{"variable":[{"type":"TX","match":[{"value":"PROTOCOL_VIOLATION\\\\\\/MISSING_HEADER","is_negated":false,"is_regex":true,"_reserved_1":66633312}],"is_count":false}],"operator":{"type":"RX","value":".*","is_regex":true,"is_negated":false,"_reserved_1":66608544},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","setvar":[{"scope":"TX","var":"missing_header","op":"INCREMENT","val":"1"},{"scope":"TX","var":"missing_header_%{tx.missing_header}","op":"ASSIGN","val":"%{matched_var_name}"}]},"hidden":false},{"variable":[{"type":"TX","match":[{"value":"MISSING_HEADER_","is_negated":false,"is_regex":true,"_reserved_1":66624816}],"is_count":false}],"operator":{"type":"RX","value":"TX\\:(.*)","is_regex":true,"is_negated":false,"_reserved_1":66607776},"action":{"capture":true,"file":"modsecurity_crs_47_common_exceptions.conf","setvar":[{"scope":"TX","var":"%{tx.1}","op":"DELETE"}],"t":["NONE"]},"hidden":false}],"hidden":false}},{"sec_rule":{"variable":[{"type":"REQUEST_METHOD","match":[{"is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"STREQ","value":"POST","is_regex":false,"is_negated":false},"action":{"id":"981022","msg":"__na__","action_type":"PASS","nolog":true,"phase":2,"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE"]},"chained_rule":[{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"User-Agent","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"Adobe Flash Player","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE"]},"hidden":false},{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"X-Flash-Version","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"RX","value":".*","is_regex":true,"is_negated":false,"_reserved_1":66618864},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE"]},"hidden":false},{"variable":[{"type":"REQUEST_HEADERS","match":[{"value":"Content-Type","is_negated":false,"is_regex":false}],"is_count":false}],"operator":{"type":"CONTAINS","value":"application/x-amf","is_regex":false,"is_negated":false},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","t":["NONE"]},"hidden":false},{"variable":[{"type":"TX","match":[{"value":"PROTOCOL_VIOLATION\\\\\\/MISSING_HEADER","is_negated":false,"is_regex":true,"_reserved_1":66619232}],"is_count":false}],"operator":{"type":"RX","value":".*","is_regex":true,"is_negated":false,"_reserved_1":66619744},"action":{"file":"modsecurity_crs_47_common_exceptions.conf","setvar":[{"scope":"TX","var":"missing_header","op":"INCREMENT","val":"1"},{"scope":"TX","var":"missing_header_%{tx.missing_header}","op":"ASSIGN","val":"%{matched_var_name}"}]},"hidden":false},{"variable":[{"type":"TX","match":[{"value":"MISSING_HEADER_","is_negated":false,"is_regex":true,"_reserved_1":66620464}],"is_count":false}],"operator":{"type":"RX","value":"TX\\:(.*)","is_regex":true,"is_negated":false,"_reserved_1":66620928},"action":{"capture":true,"file":"modsecurity_crs_47_common_exceptions.conf","setvar":[{"scope":"TX","var":"%{tx.1}","op":"DELETE"},{"scope":"TX","var":"anomaly_score","op":"DECREMENT","val":"5"}],"t":["NONE"]},"hidden":false}],"hidden":false}}]}