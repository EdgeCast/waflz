
sx_scopes.h,7599
#define _WAFLZ_SERVER_SX_SCOPES_H__WAFLZ_SERVER_SX_SCOPES_H_24,972
namespace ns_waflz {ns_waflz35,1455
namespace ns_scopez_server {ns_scopez_server38,1492
class update_scopes_h: public ns_is2::default_rqst_hupdate_scopes_h42,1703
class update_scopes_h: public ns_is2::default_rqst_hns_scopez_server::update_scopes_h42,1703
        update_scopes_h():update_scopes_h45,1766
        update_scopes_h():ns_scopez_server::update_scopes_h::update_scopes_h45,1766
        ~update_scopes_h()~update_scopes_h50,1911
        ~update_scopes_h()ns_scopez_server::update_scopes_h::~update_scopes_h50,1911
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs55,2137
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::update_scopes_h::m_scopes_configs55,2137
        bool m_bg_load;m_bg_load56,2189
        bool m_bg_load;ns_scopez_server::update_scopes_h::m_bg_load56,2189
class update_acl_h: public ns_is2::default_rqst_hupdate_acl_h61,2395
class update_acl_h: public ns_is2::default_rqst_hns_scopez_server::update_acl_h61,2395
        update_acl_h():update_acl_h64,2455
        update_acl_h():ns_scopez_server::update_acl_h::update_acl_h64,2455
        ~update_acl_h()~update_acl_h69,2597
        ~update_acl_h()ns_scopez_server::update_acl_h::~update_acl_h69,2597
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs74,2820
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::update_acl_h::m_scopes_configs74,2820
        bool m_bg_load;m_bg_load75,2872
        bool m_bg_load;ns_scopez_server::update_acl_h::m_bg_load75,2872
class update_rules_h: public ns_is2::default_rqst_hupdate_rules_h80,3080
class update_rules_h: public ns_is2::default_rqst_hns_scopez_server::update_rules_h80,3080
        update_rules_h():update_rules_h83,3142
        update_rules_h():ns_scopez_server::update_rules_h::update_rules_h83,3142
        ~update_rules_h()~update_rules_h88,3286
        ~update_rules_h()ns_scopez_server::update_rules_h::~update_rules_h88,3286
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs93,3511
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::update_rules_h::m_scopes_configs93,3511
        bool m_bg_load;m_bg_load94,3563
        bool m_bg_load;ns_scopez_server::update_rules_h::m_bg_load94,3563
class update_bots_h: public ns_is2::default_rqst_hupdate_bots_h99,3770
class update_bots_h: public ns_is2::default_rqst_hns_scopez_server::update_bots_h99,3770
        update_bots_h():update_bots_h102,3831
        update_bots_h():ns_scopez_server::update_bots_h::update_bots_h102,3831
        ~update_bots_h()~update_bots_h107,3974
        ~update_bots_h()ns_scopez_server::update_bots_h::~update_bots_h107,3974
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs112,4198
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::update_bots_h::m_scopes_configs112,4198
        bool m_bg_load;m_bg_load113,4250
        bool m_bg_load;ns_scopez_server::update_bots_h::m_bg_load113,4250
class update_profile_h: public ns_is2::default_rqst_hupdate_profile_h118,4462
class update_profile_h: public ns_is2::default_rqst_hns_scopez_server::update_profile_h118,4462
        update_profile_h():update_profile_h121,4526
        update_profile_h():ns_scopez_server::update_profile_h::update_profile_h121,4526
        ~update_profile_h()~update_profile_h126,4672
        ~update_profile_h()ns_scopez_server::update_profile_h::~update_profile_h126,4672
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs131,4899
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::update_profile_h::m_scopes_configs131,4899
        bool m_bg_load;m_bg_load132,4951
        bool m_bg_load;ns_scopez_server::update_profile_h::m_bg_load132,4951
class update_limit_h: public ns_is2::default_rqst_hupdate_limit_h137,5159
class update_limit_h: public ns_is2::default_rqst_hns_scopez_server::update_limit_h137,5159
        update_limit_h():update_limit_h140,5221
        update_limit_h():ns_scopez_server::update_limit_h::update_limit_h140,5221
        ~update_limit_h()~update_limit_h144,5331
        ~update_limit_h()ns_scopez_server::update_limit_h::~update_limit_h144,5331
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs149,5556
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::update_limit_h::m_scopes_configs149,5556
class sx_scopes: public ns_waflz_server::sx {sx_scopes154,5787
class sx_scopes: public ns_waflz_server::sx {ns_scopez_server::sx_scopes154,5787
        bool m_bg_load;m_bg_load170,6551
        bool m_bg_load;ns_scopez_server::sx_scopes::m_bg_load170,6551
        bool m_is_rand;m_is_rand171,6575
        bool m_is_rand;ns_scopez_server::sx_scopes::m_is_rand171,6575
        bool m_scopes_dir;m_scopes_dir172,6599
        bool m_scopes_dir;ns_scopez_server::sx_scopes::m_scopes_dir172,6599
        bool m_action_mode;m_action_mode173,6626
        bool m_action_mode;ns_scopez_server::sx_scopes::m_action_mode173,6626
        std::string m_redis_host;m_redis_host174,6654
        std::string m_redis_host;ns_scopez_server::sx_scopes::m_redis_host174,6654
        ns_waflz::engine *m_engine;m_engine175,6688
        ns_waflz::engine *m_engine;ns_scopez_server::sx_scopes::m_engine175,6688
        ns_waflz::kv_db *m_db;m_db176,6724
        ns_waflz::kv_db *m_db;ns_scopez_server::sx_scopes::m_db176,6724
        ns_waflz::challenge *m_b_challenge;m_b_challenge177,6755
        ns_waflz::challenge *m_b_challenge;ns_scopez_server::sx_scopes::m_b_challenge177,6755
        update_scopes_h *m_update_scopes_h;m_update_scopes_h178,6799
        update_scopes_h *m_update_scopes_h;ns_scopez_server::sx_scopes::m_update_scopes_h178,6799
        update_acl_h* m_update_acl_h;m_update_acl_h179,6843
        update_acl_h* m_update_acl_h;ns_scopez_server::sx_scopes::m_update_acl_h179,6843
        update_rules_h* m_update_rules_h;m_update_rules_h180,6881
        update_rules_h* m_update_rules_h;ns_scopez_server::sx_scopes::m_update_rules_h180,6881
        update_profile_h* m_update_profile_h;m_update_profile_h181,6923
        update_profile_h* m_update_profile_h;ns_scopez_server::sx_scopes::m_update_profile_h181,6923
        update_limit_h* m_update_limit_h;m_update_limit_h182,6969
        update_limit_h* m_update_limit_h;ns_scopez_server::sx_scopes::m_update_limit_h182,6969
        ns_waflz::scopes_configs *m_scopes_configs;m_scopes_configs183,7011
        ns_waflz::scopes_configs *m_scopes_configs;ns_scopez_server::sx_scopes::m_scopes_configs183,7011
        std::string m_config_path;m_config_path184,7063
        std::string m_config_path;ns_scopez_server::sx_scopes::m_config_path184,7063
        std::string m_ruleset_dir;m_ruleset_dir185,7098
        std::string m_ruleset_dir;ns_scopez_server::sx_scopes::m_ruleset_dir185,7098
        std::string m_geoip2_db;m_geoip2_db186,7133
        std::string m_geoip2_db;ns_scopez_server::sx_scopes::m_geoip2_db186,7133
        std::string m_geoip2_isp_db;m_geoip2_isp_db187,7166
        std::string m_geoip2_isp_db;ns_scopez_server::sx_scopes::m_geoip2_isp_db187,7166
        std::string m_conf_dir;m_conf_dir188,7203
        std::string m_conf_dir;ns_scopez_server::sx_scopes::m_conf_dir188,7203
        std::string m_b_challenge_file;m_b_challenge_file189,7235
        std::string m_b_challenge_file;ns_scopez_server::sx_scopes::m_b_challenge_file189,7235

sx_scopes.cc,5319
  #define STATUS_OK STATUS_OK50,1865
  #define STATUS_ERROR STATUS_ERROR53,1915
#define _SCOPEZ_SERVER_SCOPES_ID _SCOPEZ_SERVER_SCOPES_ID55,1948
namespace ns_scopez_server {ns_scopez_server56,1997
typedef struct _waf_scopes_bg_update {_waf_scopes_bg_update60,2197
typedef struct _waf_scopes_bg_update {ns_scopez_server::_waf_scopes_bg_update60,2197
        char* m_buf;m_buf61,2236
        char* m_buf;ns_scopez_server::_waf_scopes_bg_update::m_buf61,2236
        uint32_t m_buf_len;m_buf_len62,2257
        uint32_t m_buf_len;ns_scopez_server::_waf_scopes_bg_update::m_buf_len62,2257
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs63,2285
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::_waf_scopes_bg_update::m_scopes_configs63,2285
} waf_scopes_bg_update_t;waf_scopes_bg_update_t64,2337
} waf_scopes_bg_update_t;ns_scopez_server::waf_scopes_bg_update_t64,2337
static void* t_load_scopes(void* a_context)t_load_scopes70,2582
static void* t_load_scopes(void* a_context)ns_scopez_server::t_load_scopes70,2582
typedef struct _waf_profile_bg_update {_waf_profile_bg_update92,3378
typedef struct _waf_profile_bg_update {ns_scopez_server::_waf_profile_bg_update92,3378
        char* m_buf;m_buf93,3418
        char* m_buf;ns_scopez_server::_waf_profile_bg_update::m_buf93,3418
        uint32_t m_buf_len;m_buf_len94,3439
        uint32_t m_buf_len;ns_scopez_server::_waf_profile_bg_update::m_buf_len94,3439
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs95,3467
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::_waf_profile_bg_update::m_scopes_configs95,3467
} waf_profile_bg_update_t;waf_profile_bg_update_t96,3519
} waf_profile_bg_update_t;ns_scopez_server::waf_profile_bg_update_t96,3519
static void* t_load_profile(void* a_context)t_load_profile102,3765
static void* t_load_profile(void* a_context)ns_scopez_server::t_load_profile102,3765
typedef struct _waf_acl_bg_update {_waf_acl_bg_update124,4575
typedef struct _waf_acl_bg_update {ns_scopez_server::_waf_acl_bg_update124,4575
        char* m_buf;m_buf125,4611
        char* m_buf;ns_scopez_server::_waf_acl_bg_update::m_buf125,4611
        uint32_t m_buf_len;m_buf_len126,4632
        uint32_t m_buf_len;ns_scopez_server::_waf_acl_bg_update::m_buf_len126,4632
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs127,4660
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::_waf_acl_bg_update::m_scopes_configs127,4660
}waf_acl_bg_update_t;waf_acl_bg_update_t128,4712
}waf_acl_bg_update_t;ns_scopez_server::waf_acl_bg_update_t128,4712
static void* t_load_acl(void* a_context)t_load_acl134,4953
static void* t_load_acl(void* a_context)ns_scopez_server::t_load_acl134,4953
typedef struct _waf_rules_bg_update {_waf_rules_bg_update156,5787
typedef struct _waf_rules_bg_update {ns_scopez_server::_waf_rules_bg_update156,5787
        char* m_buf;m_buf157,5825
        char* m_buf;ns_scopez_server::_waf_rules_bg_update::m_buf157,5825
        uint32_t m_buf_len;m_buf_len158,5846
        uint32_t m_buf_len;ns_scopez_server::_waf_rules_bg_update::m_buf_len158,5846
        ns_waflz::scopes_configs* m_scopes_configs;m_scopes_configs159,5874
        ns_waflz::scopes_configs* m_scopes_configs;ns_scopez_server::_waf_rules_bg_update::m_scopes_configs159,5874
} waf_rules_bg_update_t;waf_rules_bg_update_t160,5926
} waf_rules_bg_update_t;ns_scopez_server::waf_rules_bg_update_t160,5926
static void* t_load_rules(void* a_context)t_load_rules166,6170
static void* t_load_rules(void* a_context)ns_scopez_server::t_load_rules166,6170
ns_is2::h_resp_t update_scopes_h::do_post(ns_is2::session &a_session,do_post190,7018
ns_is2::h_resp_t update_scopes_h::do_post(ns_is2::session &a_session,ns_scopez_server::update_scopes_h::do_post190,7018
ns_is2::h_resp_t update_limit_h::do_post(ns_is2::session &a_session,do_post253,9809
ns_is2::h_resp_t update_limit_h::do_post(ns_is2::session &a_session,ns_scopez_server::update_limit_h::do_post253,9809
ns_is2::h_resp_t update_acl_h::do_post(ns_is2::session &a_session,do_post296,11702
ns_is2::h_resp_t update_acl_h::do_post(ns_is2::session &a_session,ns_scopez_server::update_acl_h::do_post296,11702
ns_is2::h_resp_t update_rules_h::do_post(ns_is2::session &a_session,do_post358,14450
ns_is2::h_resp_t update_rules_h::do_post(ns_is2::session &a_session,ns_scopez_server::update_rules_h::do_post358,14450
ns_is2::h_resp_t update_profile_h::do_post(ns_is2::session &a_session,do_post419,17186
ns_is2::h_resp_t update_profile_h::do_post(ns_is2::session &a_session,ns_scopez_server::update_profile_h::do_post419,17186
sx_scopes::sx_scopes(void):sx_scopes480,19944
sx_scopes::sx_scopes(void):ns_scopez_server::sx_scopes::sx_scopes480,19944
sx_scopes::~sx_scopes(void)~sx_scopes505,20649
sx_scopes::~sx_scopes(void)ns_scopez_server::sx_scopes::~sx_scopes505,20649
int32_t sx_scopes::init(void)init523,21668
int32_t sx_scopes::init(void)ns_scopez_server::sx_scopes::init523,21668
ns_is2::h_resp_t sx_scopes::handle_rqst(waflz_pb::enforcement **ao_enf,handle_rqst713,30067
ns_is2::h_resp_t sx_scopes::handle_rqst(waflz_pb::enforcement **ao_enf,ns_scopez_server::sx_scopes::handle_rqst713,30067

scopez_server.cc,2859
  #define STATUS_OK STATUS_OK77,2791
  #define STATUS_ERROR STATUS_ERROR80,2841
#define _DEFAULT_RESP_BODY_B64 _DEFAULT_RESP_BODY_B6482,2874
#define BOGUS_GEO_DATABASE BOGUS_GEO_DATABASE83,6068
        SERVER_MODE_DEFAULT = 0,SERVER_MODE_DEFAULT88,6311
        SERVER_MODE_PROXY,SERVER_MODE_PROXY89,6344
        SERVER_MODE_FILE,SERVER_MODE_FILE90,6371
        SERVER_MODE_NONESERVER_MODE_NONE91,6397
} server_mode_t;server_mode_t92,6422
        CONFIG_MODE_SCOPES = 0,CONFIG_MODE_SCOPES94,6454
        CONFIG_MODE_SCOPES_DIR,CONFIG_MODE_SCOPES_DIR95,6486
        CONFIG_MODE_NONECONFIG_MODE_NONE96,6518
} config_mode_t;config_mode_t97,6543
ns_is2::srvr *g_srvr = NULL;g_srvr101,6734
ns_scopez_server::sx_scopes *g_sx_scopes = NULL;g_sx_scopes102,6763
static ns_is2::h_resp_t handle_enf(ns_waflz::rqst_ctx *a_ctx,handle_enf108,7031
#define STR_CMP(STR_CMP126,7684
class scopez_h: public ns_is2::default_rqst_hscopez_h450,22628
        scopez_h(): default_rqst_h() {}scopez_h453,22684
        scopez_h(): default_rqst_h() {}scopez_h::scopez_h453,22684
        ~scopez_h() {}~scopez_h454,22724
        ~scopez_h() {}scopez_h::~scopez_h454,22724
        ns_is2::h_resp_t do_default(ns_is2::session &a_session,do_default458,22904
        ns_is2::h_resp_t do_default(ns_is2::session &a_session,scopez_h::do_default458,22904
class scopez_file_h: public ns_is2::file_hscopez_file_h519,26481
        scopez_file_h(): file_h() {}scopez_file_h522,26534
        scopez_file_h(): file_h() {}scopez_file_h::scopez_file_h522,26534
        ~scopez_file_h() {}~scopez_file_h523,26571
        ~scopez_file_h() {}scopez_file_h::~scopez_file_h523,26571
        ns_is2::h_resp_t do_default(ns_is2::session &a_session,do_default527,26756
        ns_is2::h_resp_t do_default(ns_is2::session &a_session,scopez_file_h::do_default527,26756
class scopez_proxy_h: public ns_is2::proxy_hscopez_proxy_h564,28490
        scopez_proxy_h(const std::string &a_proxy_host):scopez_proxy_h567,28545
        scopez_proxy_h(const std::string &a_proxy_host):scopez_proxy_h::scopez_proxy_h567,28545
        ~scopez_proxy_h() {}~scopez_proxy_h569,28646
        ~scopez_proxy_h() {}scopez_proxy_h::~scopez_proxy_h569,28646
        ns_is2::h_resp_t do_default(ns_is2::session &a_session,do_default573,28832
        ns_is2::h_resp_t do_default(ns_is2::session &a_session,scopez_proxy_h::do_default573,28832
void sig_handler(int signo)sig_handler612,30632
void print_version(FILE* a_stream, int a_exit_code)print_version629,31073
void print_usage(FILE* a_stream, int a_exit_code)print_usage642,31625
int main(int argc, char** argv)main684,34058
#define _TEST_SET_SERVER_MODE(_TEST_SET_SERVER_MODE737,36010
#define _TEST_SET_CONFIG_MODE(_TEST_SET_CONFIG_MODE745,36373
#define ELIF_TRACE_STR(ELIF_TRACE_STR905,42407
